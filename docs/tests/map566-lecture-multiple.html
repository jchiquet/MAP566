<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.83">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MAP566 - Stats in Action - Multiple Testing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../docs/tests/map566-lab-tests.html" rel="next">
<link href="../../docs/tests/map566-lecture-single.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../logo_X.jpg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">MAP566 - Stats in Action</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../getting-started.html" rel="" target="">
 <span class="menu-text">Getting Started</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jchiquet/MAP566" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hypothesis-testing" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hypothesis Testing</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-hypothesis-testing">    
        <li class="dropdown-header">Lectures</li>
        <li>
    <a class="dropdown-item" href="../../docs/tests/map566-lecture-single.html" rel="" target="">
 <span class="dropdown-text">Statistical Tests</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/tests/map566-lecture-multiple.html" rel="" target="">
 <span class="dropdown-text">Multiple Testing</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Exercices</li>
        <li>
    <a class="dropdown-item" href="../../docs/tests/map566-lab-tests.html" rel="" target="">
 <span class="dropdown-text">Statistical tests: exercices</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-regression-models" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Regression models</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-regression-models">    
        <li class="dropdown-header">Lectures</li>
        <li>
    <a class="dropdown-item" href="../../docs/regression/map566-lecture-polynomial-regression.html" rel="" target="">
 <span class="dropdown-text">Polynomial Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/regression/map566-lecture-nonlinear-regression.html" rel="" target="">
 <span class="dropdown-text">Nonlinear Regression</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Exercices</li>
        <li>
    <a class="dropdown-item" href="../../docs/regression/map566-lab-polynomial-regression.html" rel="" target="">
 <span class="dropdown-text">Polynomial Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/regression/map566-lab-nonlinear-regression.html" rel="" target="">
 <span class="dropdown-text">Nonlinear Regression</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Supplementary material</li>
        <li>
    <a class="dropdown-item" href="../../docs/regression/map566-lecture-regression-background.html" rel="" target="">
 <span class="dropdown-text">Linear Regression: Quick Recap</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-mixed-models" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Mixed models</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-mixed-models">    
        <li class="dropdown-header">Lectures</li>
        <li>
    <a class="dropdown-item" href="../../docs/mixed-models/map566-lecture-linear-mixed-model.html" rel="" target="">
 <span class="dropdown-text">Linear Mixed Effects Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/mixed-models/map566-lecture-nonlinear-mixed-model.html" rel="" target="">
 <span class="dropdown-text">Nonlinear Mixed Effects Models</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Exercices</li>
        <li>
    <a class="dropdown-item" href="../../docs/mixed-models/map566-lab-linear-mixed-model.html" rel="" target="">
 <span class="dropdown-text">Linear Mixed Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/mixed-models/map566-lab-nonlinear-mixed-model.html" rel="" target="">
 <span class="dropdown-text">Nonlinear Mixed Effects Models</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Supplementary material</li>
        <li>
    <a class="dropdown-item" href="../../docs/mixed-models/map566-lecture-EM-linear-mixed-model.html" rel="" target="">
 <span class="dropdown-text">An EM Algorithm for Linear Mixed Effects Models</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-mixture-models" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Mixture models</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-mixture-models">    
        <li class="dropdown-header">Lectures</li>
        <li>
    <a class="dropdown-item" href="../../docs/mixture-models/map566-lecture-mixture-models.html" rel="" target="">
 <span class="dropdown-text">Mixture Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/mixture-models/map566-lecture-graph-clustering-part1.html" rel="" target="">
 <span class="dropdown-text">Hierarchical and Spectral methods for Graph clustering</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/mixture-models/map566-lecture-graph-clustering-part2.html" rel="" target="">
 <span class="dropdown-text">Stochastic block Models</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Exercices</li>
        <li>
    <a class="dropdown-item" href="../../docs/mixture-models/map566-lab-mixture-models.html" rel="" target="">
 <span class="dropdown-text">Mixture models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/mixture-models/map566-lab-graph-partionning.html" rel="" target="">
 <span class="dropdown-text">Graph Clustering: Spectral and hierarchical methods</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/mixture-models/map566-lab-stochastic-blockmodels.html" rel="" target="">
 <span class="dropdown-text">Graph Clustering: Stochastic Blockmodels</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Supplementary material</li>
        <li>
    <a class="dropdown-item" href="../../docs/mixture-models/map566-doc-mixture-models-example.html" rel="" target="">
 <span class="dropdown-text">Clustering and classification with model based approaches</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/jchiquet/MAP573/raw/master/slides/GraphClustering/GraphClustering.pdf" rel="" target="">
 <span class="dropdown-text">Slides on Graph Clustering</span></a>
  </li>  
    </ul>
  </li>
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Multiple Testing</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Lectures</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/tests/map566-lecture-single.html" class="sidebar-item-text sidebar-link">Statistical Tests</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/tests/map566-lecture-multiple.html" class="sidebar-item-text sidebar-link active">Multiple Testing</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Exercices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/tests/map566-lab-tests.html" class="sidebar-item-text sidebar-link">Statistical tests: exercices</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#distribution-of-the-p-values" id="toc-distribution-of-the-p-values" class="nav-link" data-scroll-target="#distribution-of-the-p-values"><span class="toc-section-number">1</span>  Distribution of the p-values</a>
  <ul class="collapse">
  <li><a href="#introduction-1" id="toc-introduction-1" class="nav-link" data-scroll-target="#introduction-1"><span class="toc-section-number">1.1</span>  Introduction</a></li>
  <li><a href="#single-comparison-between-2-groups" id="toc-single-comparison-between-2-groups" class="nav-link" data-scroll-target="#single-comparison-between-2-groups"><span class="toc-section-number">1.2</span>  Single comparison between 2 groups</a></li>
  <li><a href="#a-single-comparison-among-many-others" id="toc-a-single-comparison-among-many-others" class="nav-link" data-scroll-target="#a-single-comparison-among-many-others"><span class="toc-section-number">1.3</span>  A single comparison… among many others</a></li>
  <li><a href="#permutation-test" id="toc-permutation-test" class="nav-link" data-scroll-target="#permutation-test"><span class="toc-section-number">1.4</span>  Permutation test</a></li>
  </ul></li>
  <li><a href="#multiple-testing-procedures" id="toc-multiple-testing-procedures" class="nav-link" data-scroll-target="#multiple-testing-procedures"><span class="toc-section-number">2</span>  Multiple testing procedures</a>
  <ul class="collapse">
  <li><a href="#controlling-family-wise-error-rate" id="toc-controlling-family-wise-error-rate" class="nav-link" data-scroll-target="#controlling-family-wise-error-rate"><span class="toc-section-number">2.1</span>  Controlling Family Wise Error Rate</a></li>
  <li><a href="#controlling-the-false-discovery-rate" id="toc-controlling-the-false-discovery-rate" class="nav-link" data-scroll-target="#controlling-the-false-discovery-rate"><span class="toc-section-number">2.2</span>  Controlling the False Discovery Rate</a></li>
  <li><a href="#a-monte-carlo-simulation" id="toc-a-monte-carlo-simulation" class="nav-link" data-scroll-target="#a-monte-carlo-simulation"><span class="toc-section-number">2.3</span>  A Monte Carlo simulation</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="toc-section-number">3</span>  References</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jchiquet/MAP566/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Multiple Testing</h1>
<p class="subtitle lead">Lecture Notes</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introduction" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="introduction">Introduction</h2>
<div class="cell" data-warnings="false" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-1_2b550f008eda376a6b040aeefca885b1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When we perform a large number of statistical tests, some will have <span class="math inline">p</span>-values less than 0.05 purely by chance, even if all the null hypotheses are really true.</p>
<p>More precisely, if we do a large number <span class="math inline">m</span> of statistical tests, and for <span class="math inline">m_{0\cdot}</span> of them the null hypothesis is actually true, we would expect about 5% of the <span class="math inline">m_{0\cdot}</span> tests to be significant at the 0.05 level, just due to chance: these significant results are false discoveries (or false positives). On the other hand, if some alternative hypothesis are true, we can miss some of them: these non significant results are false negatives.</p>
<p><span class="math display"> \begin{array}{c|c|c|c}
&amp; \text{Null hypothesis true} &amp; \text{Alternative hypothesis true}  &amp; \\ \hline
\text{Test non significant} &amp; m_{00} &amp; m_{10} &amp; m_{\cdot 0} \\ \hline
\text{Test significant} &amp; m_{01} &amp; m_{11} &amp; m_{\cdot 1} \\ \hline
&amp; m_{0 \cdot} &amp; m_{1 \cdot} &amp; m
\end{array} </span></p>
<p>If important conclusions and decisions are based on these false positives, it is then important to control the <em>family-wise error rate</em> (FWER):</p>
<ul>
<li>the family-wise error rate is the probability of making one or more false discoveries, or type I errors when performing multiple hypotheses tests</li>
</ul>
<p><span class="math display"> FWER = \mathbb{P}(m_{01}\geq 1) </span></p>
<p>When true positives are expected, it is possible to miss some of them. We then necessarily need to accept false positives if we want to limit the number of these false negatives. It is important in such situation to control the false discovery rate (FDR)</p>
<ul>
<li>The false discovery rate (FDR) is the expected proportion of false discoveries among the discoveries</li>
</ul>
<p><span class="math display">FDR = \mathbb{E}\left(\frac{m_{01}}{m_{01} + m_{11}}\right) = \mathbb{E}\left(\frac{m_{01}}{m_{\cdot1} }\right)</span> Several procedures exist for controlling either the FWER or the FDR.</p>
</section>
<section id="distribution-of-the-p-values" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="distribution-of-the-p-values"><span class="header-section-number">1</span> Distribution of the p-values</h2>
<section id="introduction-1" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="introduction-1"><span class="header-section-number">1.1</span> Introduction</h3>
<p>The health effects of a Roundup-tolerant genetically modified maize, cultivated with or without Roundup, and Roundup alone, were studied during a 2 years study in rats.</p>
<p>For each sex, one control group had access to plain water and standard diet from the closest isogenic non-transgenic maize control; six groups were fed with 11, 22 and 33% of GM NK603 maize either treated or not with Roundup. The final three groups were fed with the control diet and had access to water supplemented with different concentrations of Roundup.</p>
<p>A sample of 200 rats including 100 males and 100 females was randomized into 20 groups of 10 rats of the same sex. Within each group, rats received the same diet. For each sex, there are therefore nine experimental groups and one control group.</p>
<p>The file <ttt>ratSurvival.csv</ttt> reports the lifespan (in days) for each animal. Here, the experiment stopped after 720 days. Then, the reported survival time is 720 for those animals who were still alive at the end of the experiment.</p>
<p>See the opinion of the <a href="http://www.hautconseildesbiotechnologies.fr/sites/www.hautconseildesbiotechnologies.fr/files/file_fields/2015/06/30/121019etudeseraliniaviscshcb.pdf">Haut Conseil des Biotechnologies</a> for more information about this study.</p>
<p>Here is a summary of the data,</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-2_6d884fe1bc40b3bbc5022f7ffdd734f2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>survival <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../../data/ratSurvival.csv"</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.character, factor) </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>survival <span class="sc">%&gt;%</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["time"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["regimen"],"name":[2],"type":["fct"],"align":["left"]},{"label":["gender"],"name":[3],"type":["fct"],"align":["left"]}],"data":[{"1":"490","2":"control","3":"male"},{"1":"575","2":"control","3":"male"},{"1":"590","2":"control","3":"male"},{"1":"605","2":"control","3":"male"},{"1":"610","2":"control","3":"male"},{"1":"635","2":"control","3":"male"},{"1":"645","2":"control","3":"male"},{"1":"675","2":"control","3":"male"},{"1":"680","2":"control","3":"male"},{"1":"720","2":"control","3":"male"},{"1":"540","2":"control","3":"female"},{"1":"645","2":"control","3":"female"},{"1":"720","2":"control","3":"female"},{"1":"720","2":"control","3":"female"},{"1":"720","2":"control","3":"female"},{"1":"720","2":"control","3":"female"},{"1":"720","2":"control","3":"female"},{"1":"720","2":"control","3":"female"},{"1":"720","2":"control","3":"female"},{"1":"720","2":"control","3":"female"},{"1":"550","2":"NK603-11%","3":"male"},{"1":"600","2":"NK603-11%","3":"male"},{"1":"650","2":"NK603-11%","3":"male"},{"1":"675","2":"NK603-11%","3":"male"},{"1":"700","2":"NK603-11%","3":"male"},{"1":"710","2":"NK603-11%","3":"male"},{"1":"720","2":"NK603-11%","3":"male"},{"1":"720","2":"NK603-11%","3":"male"},{"1":"720","2":"NK603-11%","3":"male"},{"1":"720","2":"NK603-11%","3":"male"},{"1":"550","2":"NK603-22%","3":"male"},{"1":"600","2":"NK603-22%","3":"male"},{"1":"605","2":"NK603-22%","3":"male"},{"1":"610","2":"NK603-22%","3":"male"},{"1":"650","2":"NK603-22%","3":"male"},{"1":"675","2":"NK603-22%","3":"male"},{"1":"700","2":"NK603-22%","3":"male"},{"1":"720","2":"NK603-22%","3":"male"},{"1":"720","2":"NK603-22%","3":"male"},{"1":"720","2":"NK603-22%","3":"male"},{"1":"100","2":"NK603-33%","3":"male"},{"1":"425","2":"NK603-33%","3":"male"},{"1":"450","2":"NK603-33%","3":"male"},{"1":"500","2":"NK603-33%","3":"male"},{"1":"505","2":"NK603-33%","3":"male"},{"1":"600","2":"NK603-33%","3":"male"},{"1":"650","2":"NK603-33%","3":"male"},{"1":"720","2":"NK603-33%","3":"male"},{"1":"720","2":"NK603-33%","3":"male"},{"1":"720","2":"NK603-33%","3":"male"},{"1":"430","2":"NK603-11%+R","3":"male"},{"1":"590","2":"NK603-11%+R","3":"male"},{"1":"600","2":"NK603-11%+R","3":"male"},{"1":"625","2":"NK603-11%+R","3":"male"},{"1":"630","2":"NK603-11%+R","3":"male"},{"1":"635","2":"NK603-11%+R","3":"male"},{"1":"640","2":"NK603-11%+R","3":"male"},{"1":"650","2":"NK603-11%+R","3":"male"},{"1":"660","2":"NK603-11%+R","3":"male"},{"1":"700","2":"NK603-11%+R","3":"male"},{"1":"120","2":"NK603-22%+R","3":"male"},{"1":"350","2":"NK603-22%+R","3":"male"},{"1":"355","2":"NK603-22%+R","3":"male"},{"1":"550","2":"NK603-22%+R","3":"male"},{"1":"600","2":"NK603-22%+R","3":"male"},{"1":"625","2":"NK603-22%+R","3":"male"},{"1":"635","2":"NK603-22%+R","3":"male"},{"1":"680","2":"NK603-22%+R","3":"male"},{"1":"720","2":"NK603-22%+R","3":"male"},{"1":"720","2":"NK603-22%+R","3":"male"},{"1":"300","2":"NK603-33%+R","3":"male"},{"1":"450","2":"NK603-33%+R","3":"male"},{"1":"490","2":"NK603-33%+R","3":"male"},{"1":"500","2":"NK603-33%+R","3":"male"},{"1":"625","2":"NK603-33%+R","3":"male"},{"1":"650","2":"NK603-33%+R","3":"male"},{"1":"690","2":"NK603-33%+R","3":"male"},{"1":"720","2":"NK603-33%+R","3":"male"},{"1":"720","2":"NK603-33%+R","3":"male"},{"1":"720","2":"NK603-33%+R","3":"male"},{"1":"575","2":"RoundUp A","3":"male"},{"1":"625","2":"RoundUp A","3":"male"},{"1":"635","2":"RoundUp A","3":"male"},{"1":"650","2":"RoundUp A","3":"male"},{"1":"700","2":"RoundUp A","3":"male"},{"1":"720","2":"RoundUp A","3":"male"},{"1":"720","2":"RoundUp A","3":"male"},{"1":"720","2":"RoundUp A","3":"male"},{"1":"720","2":"RoundUp A","3":"male"},{"1":"720","2":"RoundUp A","3":"male"},{"1":"500","2":"RoundUp B","3":"male"},{"1":"540","2":"RoundUp B","3":"male"},{"1":"545","2":"RoundUp B","3":"male"},{"1":"575","2":"RoundUp B","3":"male"},{"1":"675","2":"RoundUp B","3":"male"},{"1":"685","2":"RoundUp B","3":"male"},{"1":"690","2":"RoundUp B","3":"male"},{"1":"720","2":"RoundUp B","3":"male"},{"1":"720","2":"RoundUp B","3":"male"},{"1":"720","2":"RoundUp B","3":"male"},{"1":"540","2":"RoundUp C","3":"male"},{"1":"585","2":"RoundUp C","3":"male"},{"1":"590","2":"RoundUp C","3":"male"},{"1":"605","2":"RoundUp C","3":"male"},{"1":"625","2":"RoundUp C","3":"male"},{"1":"635","2":"RoundUp C","3":"male"},{"1":"660","2":"RoundUp C","3":"male"},{"1":"700","2":"RoundUp C","3":"male"},{"1":"720","2":"RoundUp C","3":"male"},{"1":"720","2":"RoundUp C","3":"male"},{"1":"380","2":"NK603-11%","3":"female"},{"1":"420","2":"NK603-11%","3":"female"},{"1":"470","2":"NK603-11%","3":"female"},{"1":"640","2":"NK603-11%","3":"female"},{"1":"675","2":"NK603-11%","3":"female"},{"1":"720","2":"NK603-11%","3":"female"},{"1":"720","2":"NK603-11%","3":"female"},{"1":"720","2":"NK603-11%","3":"female"},{"1":"720","2":"NK603-11%","3":"female"},{"1":"720","2":"NK603-11%","3":"female"},{"1":"290","2":"NK603-22%","3":"female"},{"1":"475","2":"NK603-22%","3":"female"},{"1":"480","2":"NK603-22%","3":"female"},{"1":"510","2":"NK603-22%","3":"female"},{"1":"550","2":"NK603-22%","3":"female"},{"1":"555","2":"NK603-22%","3":"female"},{"1":"650","2":"NK603-22%","3":"female"},{"1":"720","2":"NK603-22%","3":"female"},{"1":"720","2":"NK603-22%","3":"female"},{"1":"720","2":"NK603-22%","3":"female"},{"1":"640","2":"NK603-33%","3":"female"},{"1":"650","2":"NK603-33%","3":"female"},{"1":"655","2":"NK603-33%","3":"female"},{"1":"690","2":"NK603-33%","3":"female"},{"1":"695","2":"NK603-33%","3":"female"},{"1":"720","2":"NK603-33%","3":"female"},{"1":"720","2":"NK603-33%","3":"female"},{"1":"720","2":"NK603-33%","3":"female"},{"1":"720","2":"NK603-33%","3":"female"},{"1":"720","2":"NK603-33%","3":"female"},{"1":"550","2":"NK603-11%+R","3":"female"},{"1":"600","2":"NK603-11%+R","3":"female"},{"1":"605","2":"NK603-11%+R","3":"female"},{"1":"625","2":"NK603-11%+R","3":"female"},{"1":"720","2":"NK603-11%+R","3":"female"},{"1":"720","2":"NK603-11%+R","3":"female"},{"1":"720","2":"NK603-11%+R","3":"female"},{"1":"720","2":"NK603-11%+R","3":"female"},{"1":"720","2":"NK603-11%+R","3":"female"},{"1":"720","2":"NK603-11%+R","3":"female"},{"1":"495","2":"NK603-22%+R","3":"female"},{"1":"550","2":"NK603-22%+R","3":"female"},{"1":"600","2":"NK603-22%+R","3":"female"},{"1":"610","2":"NK603-22%+R","3":"female"},{"1":"615","2":"NK603-22%+R","3":"female"},{"1":"630","2":"NK603-22%+R","3":"female"},{"1":"675","2":"NK603-22%+R","3":"female"},{"1":"720","2":"NK603-22%+R","3":"female"},{"1":"720","2":"NK603-22%+R","3":"female"},{"1":"720","2":"NK603-22%+R","3":"female"},{"1":"505","2":"NK603-33%+R","3":"female"},{"1":"510","2":"NK603-33%+R","3":"female"},{"1":"655","2":"NK603-33%+R","3":"female"},{"1":"660","2":"NK603-33%+R","3":"female"},{"1":"680","2":"NK603-33%+R","3":"female"},{"1":"720","2":"NK603-33%+R","3":"female"},{"1":"720","2":"NK603-33%+R","3":"female"},{"1":"720","2":"NK603-33%+R","3":"female"},{"1":"720","2":"NK603-33%+R","3":"female"},{"1":"720","2":"NK603-33%+R","3":"female"},{"1":"455","2":"RoundUp A","3":"female"},{"1":"465","2":"RoundUp A","3":"female"},{"1":"540","2":"RoundUp A","3":"female"},{"1":"650","2":"RoundUp A","3":"female"},{"1":"700","2":"RoundUp A","3":"female"},{"1":"720","2":"RoundUp A","3":"female"},{"1":"720","2":"RoundUp A","3":"female"},{"1":"720","2":"RoundUp A","3":"female"},{"1":"720","2":"RoundUp A","3":"female"},{"1":"720","2":"RoundUp A","3":"female"},{"1":"310","2":"RoundUp B","3":"female"},{"1":"575","2":"RoundUp B","3":"female"},{"1":"625","2":"RoundUp B","3":"female"},{"1":"630","2":"RoundUp B","3":"female"},{"1":"640","2":"RoundUp B","3":"female"},{"1":"720","2":"RoundUp B","3":"female"},{"1":"720","2":"RoundUp B","3":"female"},{"1":"720","2":"RoundUp B","3":"female"},{"1":"720","2":"RoundUp B","3":"female"},{"1":"720","2":"RoundUp B","3":"female"},{"1":"340","2":"RoundUp C","3":"female"},{"1":"500","2":"RoundUp C","3":"female"},{"1":"540","2":"RoundUp C","3":"female"},{"1":"675","2":"RoundUp C","3":"female"},{"1":"680","2":"RoundUp C","3":"female"},{"1":"700","2":"RoundUp C","3":"female"},{"1":"715","2":"RoundUp C","3":"female"},{"1":"720","2":"RoundUp C","3":"female"},{"1":"720","2":"RoundUp C","3":"female"},{"1":"720","2":"RoundUp C","3":"female"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(survival<span class="sc">$</span>regimen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "control"     "NK603-11%"   "NK603-11%+R" "NK603-22%"   "NK603-22%+R"
 [6] "NK603-33%"   "NK603-33%+R" "RoundUp A"   "RoundUp B"   "RoundUp C"  </code></pre>
</div>
</div>
</section>
<section id="single-comparison-between-2-groups" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="single-comparison-between-2-groups"><span class="header-section-number">1.2</span> Single comparison between 2 groups</h3>
<p>One objective of this study is the comparison of the <em>survival time</em> between the control group and the experimental groups.</p>
<p>Consider for instance the control group of females</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-3_b27a651b427c4dcc57a504328dfbc4aa">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>time_control <span class="ot">&lt;-</span> survival <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(regimen <span class="sc">==</span> <span class="st">"control"</span>, gender <span class="sc">==</span> <span class="st">"female"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(time)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>time_control</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 540 645 720 720 720 720 720 720 720 720</code></pre>
</div>
</div>
<p>Only 2 rats of this group died before the end of the experiment. On the other hand, 7 females of the group fed with 22% of maize NK693 died during the experiment.</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-4_b49ec03e4e1848d0dc75b5bfc7afe58d">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>time_test <span class="ot">&lt;-</span> survival <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(regimen <span class="sc">==</span> <span class="st">"NK603-22%"</span>, gender <span class="sc">==</span> <span class="st">"female"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(time)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>time_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 290 475 480 510 550 555 650 720 720 720</code></pre>
</div>
</div>
<p>A negative effect of the diet on the survival means that the rats of the experimental group <em>tend to die before</em> those of the control group. Then, we would like to test</p>
<p><span class="math display">\begin{aligned}
&amp; H_0: \ "\text{the NK603 22\% diet has no effect on the survival of female rats }"\\
\text{versus } &amp; H_1: \ "\text{the NK603 22\% diet leads to decreased survival time for female rats}"\\ \end{aligned}</span></p>
<p>In terms of survival functions, that means that, under <span class="math inline">H_1</span>, the probability to be alive at a given time <span class="math inline">t</span> is lower for a rat of the experimental group than for a rat of the control group. We then would like to test</p>
<p><span class="math display">\begin{aligned}
&amp; H_0: \ ``\mathbb{P}(T_{\rm test}&gt;t) = \mathbb{P}(T_{\rm control}&gt;t), \text{ for any } t&gt;0" \\
\text{versus } &amp; H_1: \ ``\mathbb{P}(T_{\rm test}&gt;t) &lt; \mathbb{P}(T_{\rm control}&gt;t), \text{ for any } t&gt;0" \end{aligned}</span></p>
<p>Because of the (right) censoring process, we cannot just compare the mean survival times using a <span class="math inline">t</span>-test. On the other hand, we can use the <em>Wilcoxon-Mann-Whitney test</em> which precisely aims to compare the ranks of the survival times in both groups.</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-5_6684d555ae86bf2fbc7e2e2f11b0b5ba">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(time_test, time_control, <span class="at">alternative=</span><span class="st">"less"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  time_test and time_control
W = 22, p-value = 0.01144
alternative hypothesis: true location shift is less than 0</code></pre>
</div>
</div>
<p>Here, the <span class="math inline">p</span>-value should lead us to reject the null hypothesis and conclude that 22% of the GM maize in the diet has a negative effect on the survival.</p>
</section>
<section id="a-single-comparison-among-many-others" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="a-single-comparison-among-many-others"><span class="header-section-number">1.3</span> A single comparison… among many others</h3>
<p>Should we really accept this conclusion as it stands? No, because we don’t know the whole story… Remember that there are <em>9 experimental groups for each sex</em>. Then, 18 comparisons with the control groups are performed.</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-6_0e05d405f5086dc558933a19cdd5ae85">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>do_all_comparisons <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="fu">levels</span>(data<span class="sc">$</span>gender), </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(g) {</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    control <span class="ot">&lt;-</span> <span class="fu">filter</span>(data, regimen <span class="sc">==</span> <span class="st">"control"</span> <span class="sc">&amp;</span> gender<span class="sc">==</span>g) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(time)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    regimes <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">levels</span>(data<span class="sc">$</span>regimen), <span class="st">"control"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(regimes, <span class="cf">function</span>(regime) {</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>      test <span class="ot">&lt;-</span> <span class="fu">filter</span>(data, gender <span class="sc">==</span> g <span class="sc">&amp;</span> regimen <span class="sc">==</span> regime) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(time)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>      wt  <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(test, control, <span class="at">alternative =</span> <span class="st">"less"</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>(</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">gender    =</span> g,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">regime    =</span> regime,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistic =</span> <span class="fu">unname</span>(wt<span class="sc">$</span>statistic),</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">p.value   =</span> wt<span class="sc">$</span>p.value</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    }) <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>()</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  }) <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(p.value)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>all_comparisons <span class="ot">&lt;-</span> <span class="fu">do_all_comparisons</span>(survival)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>all_comparisons <span class="sc">%&gt;%</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(<span class="at">options =</span> <span class="fu">list</span>(<span class="at">rows.print =</span> <span class="dv">18</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["gender"],"name":[1],"type":["chr"],"align":["left"]},{"label":["regime"],"name":[2],"type":["chr"],"align":["left"]},{"label":["statistic"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"female","2":"NK603-22%","3":"22.0","4":"0.01143779"},{"1":"female","2":"NK603-22%+R","3":"25.0","4":"0.02131745"},{"1":"female","2":"RoundUp C","3":"26.5","4":"0.02845455"},{"1":"female","2":"NK603-11%","3":"33.0","4":"0.07166095"},{"1":"female","2":"RoundUp B","3":"34.0","4":"0.08459162"},{"1":"female","2":"RoundUp A","3":"34.5","4":"0.09156610"},{"1":"female","2":"NK603-33%+R","3":"36.0","4":"0.11556850"},{"1":"female","2":"NK603-33%","3":"39.0","4":"0.17583926"},{"1":"female","2":"NK603-11%+R","3":"40.0","4":"0.18797769"},{"1":"male","2":"NK603-33%","3":"40.5","4":"0.24733242"},{"1":"male","2":"NK603-22%+R","3":"42.0","4":"0.28493944"},{"1":"male","2":"NK603-11%+R","3":"50.0","4":"0.51508635"},{"1":"male","2":"NK603-33%+R","3":"51.0","4":"0.54532608"},{"1":"male","2":"RoundUp C","3":"54.5","4":"0.64764235"},{"1":"male","2":"RoundUp B","3":"58.5","4":"0.75283120"},{"1":"male","2":"NK603-22%","3":"64.0","4":"0.86465902"},{"1":"male","2":"NK603-11%","3":"74.5","4":"0.97160483"},{"1":"male","2":"RoundUp A","3":"75.5","4":"0.97688776"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[18],"max":[18]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Let us plot the ordered p-values:</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-7_289ecff45af87c9ad4bd14d3f543be16">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>all_comparisons <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>, <span class="at">color =</span> regime, <span class="at">y =</span> p.value, <span class="at">shape =</span> gender), <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"regime"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"p-value"</span>) <span class="sc">+</span> <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="map566-lecture-multiple_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>If we then decide to only report the largest observed differences, associated to the smallest <span class="math inline">p</span>-values, how can we conclude that these differences are statistically significant?</p>
</section>
<section id="permutation-test" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="permutation-test"><span class="header-section-number">1.4</span> Permutation test</h3>
<div class="callout callout-style-default callout-note callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Permutation test
</div>
</div>
<div class="callout-body-container callout-body">
<p>A permutation test (also called a randomization test) is a type of statistical significance test in which the distribution of the test statistic under the null hypothesis is obtained by calculating all possible values of the test statistic under rearrangements of the labels on the observed data points. If the labels are exchangeable under the null hypothesis, then the resulting tests yield exact significance levels. Prediction intervals can also be derived.</p>
</div>
</div>
<p>In our example, imagine that the null hypothesis is true. We can then randomly exchange the labels (i.e.&nbsp;the regimen) and perform the 18 comparisons between the experimental groups and the control groups.</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-8_62cc5daabf19a59a099ca77b7125fe3e">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>permuted_data <span class="ot">&lt;-</span> survival <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.<span class="sc">$</span>gender) <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(mutate, <span class="at">regimen =</span> <span class="fu">sample</span>(regimen)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">do_all_comparisons</span>(permuted_data) <span class="sc">%&gt;%</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["gender"],"name":[1],"type":["chr"],"align":["left"]},{"label":["regime"],"name":[2],"type":["chr"],"align":["left"]},{"label":["statistic"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"male","2":"NK603-22%","3":"32.5","4":"0.09811144"},{"1":"male","2":"RoundUp B","3":"34.5","4":"0.12752259"},{"1":"female","2":"RoundUp A","3":"36.0","4":"0.13777305"},{"1":"female","2":"NK603-22%+R","3":"37.0","4":"0.16072597"},{"1":"female","2":"RoundUp C","3":"38.0","4":"0.18094148"},{"1":"male","2":"NK603-11%+R","3":"37.5","4":"0.18163078"},{"1":"female","2":"RoundUp B","3":"38.5","4":"0.18704487"},{"1":"female","2":"NK603-11%+R","3":"41.0","4":"0.24618786"},{"1":"female","2":"NK603-33%","3":"46.0","4":"0.38605736"},{"1":"female","2":"NK603-11%","3":"47.5","4":"0.43222039"},{"1":"female","2":"NK603-33%+R","3":"50.0","4":"0.51701394"},{"1":"female","2":"NK603-22%","3":"52.0","4":"0.58774468"},{"1":"male","2":"NK603-33%+R","3":"52.5","4":"0.59006895"},{"1":"male","2":"NK603-33%","3":"56.0","4":"0.68946564"},{"1":"male","2":"RoundUp A","3":"60.0","4":"0.78807548"},{"1":"male","2":"NK603-22%+R","3":"61.0","4":"0.81139146"},{"1":"male","2":"NK603-11%","3":"62.5","4":"0.83904950"},{"1":"male","2":"RoundUp C","3":"70.5","4":"0.94800363"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The test statistics and the <span class="math inline">p</span>-values now really behave how they are supposed to behave under the null hypothesis. Let us plot this:</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-9_1e4ea9abef6cdf406b2db77af365af72">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">do_all_comparisons</span>(permuted_data) <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>, <span class="at">color =</span> regime, <span class="at">y =</span> p.value, <span class="at">shape =</span> gender), <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"regime"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"p-value"</span>) <span class="sc">+</span> <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="map566-lecture-multiple_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Is this really different from the plot we obtained before, with the original data? To answer this question we repeat the same experiment using many different permutations. We will be able to estimate the <span class="math inline">m</span> distributions of the <span class="math inline">m</span> test statistics as well as the <span class="math inline">m</span> distributions of the <span class="math inline">m</span> <span class="math inline">p</span>-values under the null hypothesis.</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-10_02fb424142b9eee50c39ced0751afdd0">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>n_replicates <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_replicates, <span class="cf">function</span>(i) {</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  permuted_data <span class="ot">&lt;-</span> survival <span class="sc">%&gt;%</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">split</span>(.<span class="sc">$</span>gender) <span class="sc">%&gt;%</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(mutate, <span class="at">regimen =</span> <span class="fu">sample</span>(regimen)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do_all_comparisons</span>(permuted_data) <span class="sc">%&gt;%</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(statistic, p.value) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">simu =</span> i)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>}, <span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()) <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can estimate, for instance, prediction intervals of level 90% for the <span class="math inline">m=18</span> ordered <span class="math inline">p</span>-values</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-11_0a48dd34792fe9b26c9f33d864f9e654">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>quantiles_pvalues <span class="ot">&lt;-</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(res, res<span class="sc">$</span>simu) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(pull, p.value) <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(sort) <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(<span class="dv">1</span>, quantile, <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>)) <span class="sc">%&gt;%</span> <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"median"</span>,<span class="st">"up"</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and plot them, with the original <span class="math inline">p</span>-values</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-12_6c37a7808eba4f6d90426e84b73307e3">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>quantiles_pvalues <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> rank, <span class="at">ymin =</span> low, <span class="at">ymax =</span> up), <span class="at">width=</span><span class="fl">0.2</span>, <span class="at">linewidth=</span><span class="fl">1.5</span>, <span class="at">colour=</span><span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"regimen"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"p-value"</span>) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="cn">NULL</span>)  <span class="sc">+</span>  </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">data =</span> all_comparisons, <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>, <span class="at">color =</span> regime, <span class="at">y =</span> p.value, <span class="at">shape=</span>gender), <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="map566-lecture-multiple_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Here, all the <span class="math inline">p</span>-values, including the smallest ones, belong to the 90% prediction intervals: <em>all the observed <span class="math inline">p</span>-values behave individually how they are expected to behave under the null hypothesis</em>.</p>
<p>In particular, when 18 comparisons are performed, it’s not unlikely under the null hypothesis to obtain a smallest p-value less than or equal to the observed one (0.011).</p>
<p>The probability of such event can easily be estimated by Monte Carlo simulation. Let <span class="math inline">p_{(1),\ell}</span> be the smallest p-value obtained from the <span class="math inline">\ell</span>-th replicate of the Monte Carlo. Then,</p>
<p><span class="math display">
\mathbb{P}\left(p_{(1)} \leq p_{(1)}^{\mathrm{obs}}\right) \approx \frac{1}{L} \sum_{\ell=1}^{L} \mathbf{1}_{\left\{p_{(1),\ell} \leq p_{(1)}^{\mathrm{obs}}\right\}}
</span></p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-13_ec28706054a766ade1e9df7af0b52d6a">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>stat_rank1 <span class="ot">&lt;-</span> <span class="fu">split</span>(res, res<span class="sc">$</span>simu) <span class="sc">%&gt;%</span> <span class="fu">map_dbl</span>(<span class="cf">function</span>(x) <span class="fu">sort</span>(x<span class="sc">$</span>statistic)[<span class="dv">1</span>])</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(stat_rank1 <span class="sc">&lt;</span> all_comparisons<span class="sc">$</span>statistic[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.153</code></pre>
</div>
</div>
</section>
</section>
<section id="multiple-testing-procedures" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="multiple-testing-procedures"><span class="header-section-number">2</span> Multiple testing procedures</h2>
<section id="controlling-family-wise-error-rate" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="controlling-family-wise-error-rate"><span class="header-section-number">2.1</span> Controlling Family Wise Error Rate</h3>
<section id="the-bonferroni-correction" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="the-bonferroni-correction">The Bonferroni correction</h4>
<p>Imagine that we perform <span class="math inline">m</span> comparisons and that all the <span class="math inline">m</span> null hypotheses are true, i.e.&nbsp;<span class="math inline">m=m_{0\cdot}</span>.. If we use the same significance level <span class="math inline">\alpha_m</span> for the <span class="math inline">m</span> tests, how should we choose <span class="math inline">\alpha_m</span> in order to control the family-wise error rate (FWER)?</p>
<p><span class="math display"> \begin{aligned}
{\rm FWER} &amp;= \mathbb{P}(m_{01}\geq 1) \\
&amp;= 1 - \mathbb{P}(m_{01}= 0)  \\
&amp;= 1 - (1-\alpha_m)^m
\end{aligned} </span></p>
<p>Then, if we set FWER<span class="math inline">=\alpha</span>, the significance level for each individual test should be <span class="math display">\begin{aligned}
\alpha_m &amp;=  1 - (1-\alpha)^{\frac{1}{m}} \quad \quad (\text{Sidak correction})\\
&amp; \simeq  \frac{\alpha}{m} \quad \quad (\text{Bonferroni correction})
\end{aligned}</span></p>
<p>Let <span class="math inline">p_k</span> be the <span class="math inline">p</span>-value of the <span class="math inline">k</span>-th test. Using the Bonferroni correction, the <span class="math inline">k</span>-th test is significant if <span class="math display">  p_k \leq \alpha_m \quad  \Longleftrightarrow \quad   m \, p_k \leq \alpha </span> We can then either compare the original <span class="math inline">p</span>-value <span class="math inline">p_k</span> to the corrected significance level <span class="math inline">\alpha/m</span>, or compare the <em>adjusted</em> <span class="math inline">p</span>-value <span class="math inline">p_k^{\rm (bonferroni)} =\min(1, m \, p_k)</span> to the critical value <span class="math inline">\alpha</span>.</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-14_01ae3178236ba48c05a83f4a90fccfa4">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(all_comparisons)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>all_comparisons<span class="sc">$</span>p.value_bonferonni <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="dv">1</span>, all_comparisons<span class="sc">$</span>p.value <span class="sc">*</span> m)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>all_comparisons <span class="sc">%&gt;%</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["gender"],"name":[1],"type":["chr"],"align":["left"]},{"label":["regime"],"name":[2],"type":["chr"],"align":["left"]},{"label":["statistic"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value_bonferonni"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"female","2":"NK603-22%","3":"22.0","4":"0.01143779","5":"0.2058803"},{"1":"female","2":"NK603-22%+R","3":"25.0","4":"0.02131745","5":"0.3837141"},{"1":"female","2":"RoundUp C","3":"26.5","4":"0.02845455","5":"0.5121818"},{"1":"female","2":"NK603-11%","3":"33.0","4":"0.07166095","5":"1.0000000"},{"1":"female","2":"RoundUp B","3":"34.0","4":"0.08459162","5":"1.0000000"},{"1":"female","2":"RoundUp A","3":"34.5","4":"0.09156610","5":"1.0000000"},{"1":"female","2":"NK603-33%+R","3":"36.0","4":"0.11556850","5":"1.0000000"},{"1":"female","2":"NK603-33%","3":"39.0","4":"0.17583926","5":"1.0000000"},{"1":"female","2":"NK603-11%+R","3":"40.0","4":"0.18797769","5":"1.0000000"},{"1":"male","2":"NK603-33%","3":"40.5","4":"0.24733242","5":"1.0000000"},{"1":"male","2":"NK603-22%+R","3":"42.0","4":"0.28493944","5":"1.0000000"},{"1":"male","2":"NK603-11%+R","3":"50.0","4":"0.51508635","5":"1.0000000"},{"1":"male","2":"NK603-33%+R","3":"51.0","4":"0.54532608","5":"1.0000000"},{"1":"male","2":"RoundUp C","3":"54.5","4":"0.64764235","5":"1.0000000"},{"1":"male","2":"RoundUp B","3":"58.5","4":"0.75283120","5":"1.0000000"},{"1":"male","2":"NK603-22%","3":"64.0","4":"0.86465902","5":"1.0000000"},{"1":"male","2":"NK603-11%","3":"74.5","4":"0.97160483","5":"1.0000000"},{"1":"male","2":"RoundUp A","3":"75.5","4":"0.97688776","5":"1.0000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Using the Bonferroni correction, none of the 18 comparisons is significant.</p>
<p><strong>Remark:</strong> the function <code>p.adjust</code> proposes several adjustements of the <span class="math inline">p</span>-values for multiple comparisons, including the Bonferroni adjustment:</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-15_05539e5511a0342b00f16de2b69585d4">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(all_comparisons<span class="sc">$</span>p.value, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.2058803 0.3837141 0.5121818 1.0000000 1.0000000 1.0000000 1.0000000
 [8] 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
[15] 1.0000000 1.0000000 1.0000000 1.0000000</code></pre>
</div>
</div>
<p>The Bonferroni correction is appropriate when a single false positive in a set of tests would be a problem. It is mainly useful when there are a fairly small number of multiple comparisons and very few of them might be significant. The main drawback of the Bonferroni correction is its lack of power: it may lead to a very high rate of false negatives.</p>
<!-- Assume, for instance that all the female rats of all the experimental groups die before the end of the experiment. Each of the $m=18$ original tests is significant, but the Bonferroni correction would lead to considering none of these tests as significant: -->
<!-- ```{r, message=FALSE, warning=FALSE} -->
<!-- x <- subset(data, regimen=="control" & gender=="female")$time -->
<!-- y <- seq(610,700,length=10) -->
<!-- c(wilcox.test(x,y,"greater")$p.value, wilcox.test(x,y,"greater")$p.value*18) -->
<!-- ```  -->
</section>
</section>
<section id="controlling-the-false-discovery-rate" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="controlling-the-false-discovery-rate"><span class="header-section-number">2.2</span> Controlling the False Discovery Rate</h3>
<section id="detecting-associations" class="level4" data-number="2.2.1">
<h4 data-number="2.2.1" class="anchored" data-anchor-id="detecting-associations"><span class="header-section-number">2.2.1</span> Detecting associations</h4>
<p>(Example from <a href="http://www.biostathandbook.com/multiplecomparisons.html">Handbook of Biological Statistics</a>)</p>
<p><span class="citation" data-cites="garcia2014calorie">Garcı́a-Arenzana et al. (<a href="#ref-garcia2014calorie" role="doc-biblioref">2014</a>)</span> tested associations of 25 dietary variables with <a href="https://breast-cancer-research.biomedcentral.com/articles/10.1186/bcr2102">mammographic density</a>, an important risk factor for breast cancer, in Spanish women. They found the following results</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-16_52783be4533d6ef6a8acc44658f8f608">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../../data/dietary.csv"</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.character, factor) </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["dietary"],"name":[1],"type":["fct"],"align":["left"]},{"label":["p-value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Total calories","2":"0.001"},{"1":"Olive oil","2":"0.008"},{"1":"Whole milk","2":"0.039"},{"1":"White meat","2":"0.041"},{"1":"Proteins","2":"0.042"},{"1":"Nuts","2":"0.061"},{"1":"Cereals and pasta","2":"0.074"},{"1":"White fish","2":"0.205"},{"1":"Butter","2":"0.212"},{"1":"Vegetables","2":"0.216"},{"1":"Skimmed milk","2":"0.222"},{"1":"Red meat","2":"0.251"},{"1":"Fruit","2":"0.269"},{"1":"Eggs","2":"0.275"},{"1":"Blue fish","2":"0.340"},{"1":"Legumes","2":"0.341"},{"1":"Carbohydrates","2":"0.384"},{"1":"Potatoes","2":"0.569"},{"1":"Bread","2":"0.594"},{"1":"Fats","2":"0.696"},{"1":"Sweets","2":"0.762"},{"1":"Dairy products","2":"0.940"},{"1":"Semi-skimmed milk","2":"0.942"},{"1":"Total meat","2":"0.975"},{"1":"Processed meat","2":"0.986"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We can see that five of the variables show a significant <span class="math inline">p</span>-value (&lt;0.05). However, because <span class="citation" data-cites="garcia2014calorie">Garcı́a-Arenzana et al. (<a href="#ref-garcia2014calorie" role="doc-biblioref">2014</a>)</span> tested 25 dietary variables, we would expect one or two variables to show a significant result purely by chance, even if diet had no real effect on mammographic density.</p>
<p>Applying the Bonferroni correction, we divide <span class="math inline">\alpha=0.05</span> by the number of tests (<span class="math inline">m=25</span>) to get the Bonferroni critical value, so a test would have to have <span class="math inline">p&lt;0.002</span> to be significant. Under that criterion, only the test for total calories is significant.</p>
</section>
<section id="the-benjamini-hochberg-procedure" class="level4" data-number="2.2.2">
<h4 data-number="2.2.2" class="anchored" data-anchor-id="the-benjamini-hochberg-procedure"><span class="header-section-number">2.2.2</span> The Benjamini-Hochberg procedure</h4>
<div class="callout callout-style-default callout-note callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Controlling FDR
</div>
</div>
<div class="callout-body-container callout-body">
<p>An alternative approach is to control the false discovery rate, i.e the expected proportion of “discoveries” (significant results) that are actually false positives. FDR control offers a way to increase power while maintaining some principled bound on error.</p>
<p>Imagine for instance that we compare expression levels for 20,000 genes between liver tumors and normal liver cells. We are going to do additional experiments on any genes that show a significant difference between the normal and tumor cells. Then, because we don’t want to miss genes of interest, we are willing to accept up to 25% of the genes with significant results being false positives. We’ll find out they’re false positives when we do the followup experiments. In this case, we would set the false discovery rate to 25%.</p>
</div>
</div>
<p>The <span class="citation" data-cites="benjamini1995controlling">Benjamini and Hochberg (<a href="#ref-benjamini1995controlling" role="doc-biblioref">1995</a>)</span> procedure (BH) controls the FDR… and it is simple to use!</p>
<p>Indeed, for a given <span class="math inline">\alpha</span> and a given sequence of <strong>ordered</strong> <span class="math inline">p</span>-values <span class="math inline">P_{(1)}</span>, <span class="math inline">P_{(2)}</span>, , <span class="math inline">P_{(m)}</span>, it consists in computing the <span class="math inline">m</span> <em>adjusted</em> <span class="math inline">p</span>-values defined as</p>
<p><span class="math display">P_{(i)}^{\rm BH} = \min\left( P_{(i)}\frac{m}{i} \ , \ P_{(i+1)}^{\rm BH} \right)</span></p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-17_d4a036cceafcd4e95e285c173c31d283">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>p.bh <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">p-value</span><span class="st">`</span>, <span class="at">method =</span> <span class="st">"BH"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["dietary"],"name":[1],"type":["fct"],"align":["left"]},{"label":["p-value"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["p.bh"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Total calories","2":"0.001","3":"0.0250000"},{"1":"Olive oil","2":"0.008","3":"0.1000000"},{"1":"Whole milk","2":"0.039","3":"0.2100000"},{"1":"White meat","2":"0.041","3":"0.2100000"},{"1":"Proteins","2":"0.042","3":"0.2100000"},{"1":"Nuts","2":"0.061","3":"0.2541667"},{"1":"Cereals and pasta","2":"0.074","3":"0.2642857"},{"1":"White fish","2":"0.205","3":"0.4910714"},{"1":"Butter","2":"0.212","3":"0.4910714"},{"1":"Vegetables","2":"0.216","3":"0.4910714"},{"1":"Skimmed milk","2":"0.222","3":"0.4910714"},{"1":"Red meat","2":"0.251","3":"0.4910714"},{"1":"Fruit","2":"0.269","3":"0.4910714"},{"1":"Eggs","2":"0.275","3":"0.4910714"},{"1":"Blue fish","2":"0.340","3":"0.5328125"},{"1":"Legumes","2":"0.341","3":"0.5328125"},{"1":"Carbohydrates","2":"0.384","3":"0.5647059"},{"1":"Potatoes","2":"0.569","3":"0.7815789"},{"1":"Bread","2":"0.594","3":"0.7815789"},{"1":"Fats","2":"0.696","3":"0.8700000"},{"1":"Sweets","2":"0.762","3":"0.9071429"},{"1":"Dairy products","2":"0.940","3":"0.9860000"},{"1":"Semi-skimmed milk","2":"0.942","3":"0.9860000"},{"1":"Total meat","2":"0.975","3":"0.9860000"},{"1":"Processed meat","2":"0.986","3":"0.9860000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Then, the discoveries, i.e.&nbsp;the significant tests, are those with an adjusted p-value less than <span class="math inline">\alpha</span>.</p>
<p>It can be shown that this procedure guarantees that for <em>independent tests</em>, and for <em>any alternative hypothesis</em>,</p>
<p><span class="math display">\begin{aligned}
{\rm FDR} &amp;= \mathbb{E}\left(\frac{m_{01}}{m_{01} + m_{11}}\right) \\
&amp;\leq \frac{m_{0\cdot}}{m} \alpha \\
&amp;\leq \alpha
\end{aligned}</span></p>
<p>where <span class="math inline">m_{0\cdot}</span> is the (unknown) total number of true null hypotheses, and where the first inequality is an equality with continuous <span class="math inline">p</span>-value distributions.</p>
<p>In our example, the first five tests would be significant with <span class="math inline">\alpha=0.25</span>, which means that we expect no more than 25% of these 5 tests to be false discoveries.</p>
<p><strong>Remark 1:</strong> The BH procedure is equivalent to consider as significant the non adjusted <span class="math inline">p</span>-values smaller than a threshold <span class="math inline">P_{\rm BH}</span> defined as</p>
<p><span class="math display"> P_{\rm BH} = \max_i \left\{ P_{(i)}: \ \ P_{(i)} \leq \alpha \frac{i}{m}  \right\} </span></p>
<p>In other words, the largest <span class="math inline">p</span>-value that has <span class="math inline">P_{(i)}&lt;(i/m)\alpha</span> is significant, and all of the <span class="math inline">p</span>-values smaller than it are also significant, even the ones that aren’t less than their Benjamini-Hochberg critical value <span class="math inline">\alpha \times i/m</span></p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-18_cf15760dbbc6af1c2c6e30a3fcb1d73d">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>critical.value <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span>m)<span class="sc">/</span>m<span class="sc">*</span>alpha</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 × 4
   dietary           `p-value`  p.bh critical.value
   &lt;fct&gt;                 &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt;
 1 Total calories        0.001 0.025           0.01
 2 Olive oil             0.008 0.1             0.02
 3 Whole milk            0.039 0.21            0.03
 4 White meat            0.041 0.21            0.04
 5 Proteins              0.042 0.21            0.05
 6 Nuts                  0.061 0.254           0.06
 7 Cereals and pasta     0.074 0.264           0.07
 8 White fish            0.205 0.491           0.08
 9 Butter                0.212 0.491           0.09
10 Vegetables            0.216 0.491           0.1 
# … with 15 more rows</code></pre>
</div>
</div>
<p>If we plot this, we clearly exhibit two regimen in the behaviour of the p-values distribution:</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-19_ec582d31b6ee3e705404eafe43fe5a39">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>pl1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span>m,<span class="at">y=</span><span class="st">`</span><span class="at">p-value</span><span class="st">`</span>), <span class="at">colour=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span>m,<span class="at">y=</span>critical.value), <span class="at">colour=</span><span class="st">"red"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"(i)"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(pl1, pl1 <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">8</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.21</span>)) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fl">5.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="map566-lecture-multiple_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>The largest <span class="math inline">p</span>-value with <span class="math inline">P_{(i)}&lt;(i/m)\alpha</span> is <em>proteins</em>, where the individual <span class="math inline">p</span>-value (0.042) is less than the <span class="math inline">(i/m)\alpha</span> value of 0.050. Thus the first five tests would be significant.</p>
<p><strong>Remark 2:</strong> The FDR is not bounded by <span class="math inline">\alpha</span>, but by <span class="math inline">(m_{0\cdot}/m) \alpha</span>. We could increase the global power of the tests and get a FDR equal to the desired level <span class="math inline">\alpha</span>, either by defining the critical values as <span class="math inline">(i/m_{0\cdot})\alpha</span>, or by multiplying the adjusted <span class="math inline">p</span>-values by <span class="math inline">m_{0\cdot}/m</span>.</p>
<p>Unfortunately, <span class="math inline">m_{0\cdot}</span> is unknown… but it can be estimated, as the number of non significant tests for instance.</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-20_213609e25ff24405f92c9cd6a863b59e">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>m0.est <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>p.bh<span class="sc">&gt;</span>alpha)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>crit.valc <span class="ot">&lt;-</span> <span class="fu">round</span>(data<span class="sc">$</span>critical.value<span class="sc">*</span>m<span class="sc">/</span>m0.est,<span class="dv">4</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>p.bhc <span class="ot">&lt;-</span> <span class="fu">round</span>(data<span class="sc">$</span>p.bh<span class="sc">*</span>m0.est<span class="sc">/</span>m,<span class="dv">4</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 6
   dietary           `p-value`  p.bh critical.value crit.valc p.bhc
   &lt;fct&gt;                 &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1 Total calories        0.001 0.025           0.01    0.0125 0.02 
 2 Olive oil             0.008 0.1             0.02    0.025  0.08 
 3 Whole milk            0.039 0.21            0.03    0.0375 0.168
 4 White meat            0.041 0.21            0.04    0.05   0.168
 5 Proteins              0.042 0.21            0.05    0.0625 0.168
 6 Nuts                  0.061 0.254           0.06    0.075  0.203
 7 Cereals and pasta     0.074 0.264           0.07    0.0875 0.211
 8 White fish            0.205 0.491           0.08    0.1    0.393
 9 Butter                0.212 0.491           0.09    0.112  0.393
10 Vegetables            0.216 0.491           0.1     0.125  0.393</code></pre>
</div>
</div>
<p>We would consider the 7 first <span class="math inline">p</span>-values as significant using this new correction.</p>
</section>
</section>
<section id="a-monte-carlo-simulation" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="a-monte-carlo-simulation"><span class="header-section-number">2.3</span> A Monte Carlo simulation</h3>
<p>Let us perform a Monte Carlo simulation to better understand the impact of these corrections.</p>
<p>Let us assume that we observe <span class="math inline">(x_{ij}, 1\leq i \leq n_x, 1 \leq j \leq m)</span> and <span class="math inline">(y_{ij}, 1\leq i \leq n_y, 1 \leq j \leq m)</span> where ,</p>
<p><span class="math display">\begin{aligned}
x_{ij} &amp; \sim^{iid} {\cal N}(\mu_{x,j} \ , \ \sigma_x^2) \\
y_{ij} &amp; \sim^{iid} {\cal N}(\mu_{y,j} \ , \ \sigma_y^2)
\end{aligned}</span></p>
<p>For <span class="math inline">j=1,2,\ldots, m</span>, we want to test <span class="math inline">H_{0,j}: \mu_{x,j}=\mu_{y,j}</span> versus <span class="math inline">H_{1,j}: \mu_{x,j} \neq \mu_{y,j}</span>.</p>
<p>For the simulation, we will use <span class="math inline">m=140</span>, <span class="math inline">n_x=n_y=50</span>, <span class="math inline">\sigma_x^2=\sigma_y^2=1</span> and <span class="math inline">\mu_{x,j}=0</span> for <span class="math inline">1\leq j \leq m</span>.</p>
<p>Furthermore, the null hypothesis is true for the first <span class="math inline">m_{0,\cdot}=120</span> variables, assuming that <span class="math inline">\mu_{y,j}=0</span> for <span class="math inline">1\leq j \leq m_{0,\cdot}</span>. Then, for <span class="math inline">m_{0,\cdot}+1\leq j \leq m</span>, <span class="math inline">\mu_{y,j}</span> varies from 0.3 to 0.6, which means that the alternative hypothesis is true for these <span class="math inline">m_{1,\cdot}=20</span> variables.</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/test-multiple-mc-settings_06188e0bbc1f70cbc20b823366cacae9">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>nx <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>ny <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>mu_x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m0 <span class="sc">+</span> m1)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>mu_y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m0), <span class="fu">seq</span>(<span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="at">length =</span> m1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For each of the <span class="math inline">L=1000</span> simulated replicate of the same experiment, we will randomly sample observation <span class="math inline">x</span> and <span class="math inline">y</span> from the model and perform a <span class="math inline">t</span>-test for each of the <span class="math inline">m=140</span> variables. We therefore get <span class="math inline">m=140</span> <span class="math inline">p</span>-values for each of these <span class="math inline">L=1000</span> replicates.</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/test-multiple-mc-simus_d4ed4b65734db66e6d54d4e7e47ba4c8">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> m0 <span class="sc">+</span> m1</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>pvalues <span class="ot">&lt;-</span> <span class="fu">replicate</span>(L, {</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">map</span>(mu_x, <span class="sc">~</span><span class="fu">rnorm</span>(<span class="at">n =</span> nx, <span class="at">mean =</span> .x))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">map</span>(mu_y, <span class="sc">~</span><span class="fu">rnorm</span>(<span class="at">n =</span> ny, <span class="at">mean =</span> .x))</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map2_dbl</span>(x, y, <span class="sc">~</span><span class="fu">t.test</span>(<span class="at">x =</span> .x, <span class="at">y =</span> .y)<span class="sc">$</span>p.value)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Setting the significance level <span class="math inline">\alpha</span> to 0.2, we can compute for each replicate the numbers of true and false discoveries <span class="math inline">m_{11}</span> and <span class="math inline">m_{01}</span>, as well as the numbers of true and false non-discoveries <span class="math inline">m_{00}</span> and <span class="math inline">m_{10}</span>.</p>
<p>We can then compute the proportion of wrongly rejected null hypotheses</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-21_725de3dac89f239546f8fa37edf16d62">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>m01 <span class="ot">&lt;-</span> <span class="fu">colSums</span>(pvalues[<span class="dv">1</span><span class="sc">:</span>m0, ] <span class="sc">&lt;</span> alpha)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(m01<span class="sc">/</span>m0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1992167</code></pre>
</div>
</div>
<p>As expected, this proportion is close to <span class="math inline">\alpha</span> which is precisely the probability to wrongly reject the null hypothesis.</p>
<p>The proportion of correctly rejected null hypotheses is an estimate of the power of the test</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-22_05f249171def16d20160c5badde31de4">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>m11 <span class="ot">&lt;-</span> <span class="fu">colSums</span>(pvalues[(m0 <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>m,] <span class="sc">&lt;</span> alpha)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(m11<span class="sc">/</span>m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.80845</code></pre>
</div>
</div>
<p>The False Discovery Rate is estimated as the proportion of false discoveries</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-23_15d0db45fe7ca94cdc34dfba4486f593">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(m01<span class="sc">/</span>(m01<span class="sc">+</span>m11))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5929069</code></pre>
</div>
</div>
<p>This means that among the significant results, about 60% of them are false discoveries.</p>
<p>Let us now apply the Bonferroni correction, and compute the proportion of wrongly and correctly rejected null hypotheses and the proportion of false discoveries</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-24_20a5afb93652588f421b60ff255a465e">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>pvalues_bonferonni <span class="ot">&lt;-</span> <span class="fu">apply</span>(pvalues, <span class="dv">2</span>, p.adjust, <span class="at">method=</span><span class="st">"bonferroni"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>m01_bonferonni <span class="ot">&lt;-</span> <span class="fu">colSums</span>(pvalues_bonferonni[<span class="dv">1</span><span class="sc">:</span>m0,] <span class="sc">&lt;</span> alpha)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>m11_bonferonni <span class="ot">&lt;-</span> <span class="fu">colSums</span>(pvalues_bonferonni[(m0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m,] <span class="sc">&lt;</span> alpha)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fu">c</span>(<span class="fu">mean</span>(m01_bonferonni <span class="sc">/</span> m0) ,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> <span class="fu">mean</span>(m11_bonferonni <span class="sc">/</span> m1) ,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">fdr   =</span> <span class="fu">mean</span>(m01_bonferonni <span class="sc">/</span> (m01_bonferonni <span class="sc">+</span> m11_bonferonni), <span class="at">na.rm=</span><span class="cn">TRUE</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     alpha1 alpha.power   alpha.fdr 
 0.00132500  0.18750000  0.03714447 </code></pre>
</div>
</div>
<p>Very few of the true null hypotheses are rejected, which may be a good point, but the price to pay is a very low power (less that 20%).</p>
<p>The familywise error rate (FWER) is the probability <span class="math inline">\mathbb{P}{m_{01}\geq 1}</span> to reject <em>at least</em> one of the true null hypothesis. This probability remains quite small when the Bonferroni correction is used.</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-25_96f03d9a4a67176539d1519956f229cd">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(m01_bonferonni <span class="sc">&gt;=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.144</code></pre>
</div>
</div>
<p>The Benjamini-Hochberg correction increases the power and controls the FDR as expected since the proportion of false discoveries remains below the level <span class="math inline">\alpha</span>.</p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-26_92051b32c75452b919453808de81c685">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pvalues_BH <span class="ot">&lt;-</span> <span class="fu">apply</span>(pvalues, <span class="dv">2</span>, p.adjust, <span class="at">method=</span><span class="st">"BH"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>m01_BH <span class="ot">&lt;-</span> <span class="fu">colSums</span>(pvalues_BH[<span class="dv">1</span><span class="sc">:</span>m0,] <span class="sc">&lt;</span> alpha)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>m11_BH <span class="ot">&lt;-</span> <span class="fu">colSums</span>(pvalues_BH[(m0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m,] <span class="sc">&lt;</span> alpha)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fu">c</span>(<span class="fu">mean</span>(m01_BH <span class="sc">/</span> m0),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> <span class="fu">mean</span>(m11_BH <span class="sc">/</span> m1),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">fdr   =</span> <span class="fu">mean</span>(m01_BH<span class="sc">/</span>(m01_BH <span class="sc">+</span> m11_BH),<span class="at">na.rm=</span><span class="cn">TRUE</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     alpha1 alpha.power   alpha.fdr 
 0.01763333  0.43130000  0.17117163 </code></pre>
</div>
</div>
<p>Lastly, we can slightly improve the BH procedure by multiplying the <span class="math inline">p</span>-values by the ratio <span class="math inline">\hat{m}_{0\cdot}/m</span></p>
<div class="cell" data-hash="map566-lecture-multiple_cache/html/unnamed-chunk-27_8fcdb6e8b6d55a399f4c42d58a029f0f">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>m0m <span class="ot">&lt;-</span> <span class="fu">colSums</span>(pvalues_BH <span class="sc">&gt;</span> alpha)<span class="sc">/</span>m</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>pvalues_BH_corrected <span class="ot">&lt;-</span> <span class="fu">sweep</span>(pvalues_BH, <span class="dv">2</span>, m0m, <span class="st">"*"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>m01_BH_corrected <span class="ot">&lt;-</span> <span class="fu">colSums</span>(pvalues_BH_corrected[<span class="dv">1</span><span class="sc">:</span>m0,] <span class="sc">&lt;</span> alpha)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>m11_BH_corrected <span class="ot">&lt;-</span> <span class="fu">colSums</span>(pvalues_BH_corrected[(m0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m,] <span class="sc">&lt;</span> alpha)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fu">c</span>(<span class="fu">mean</span>(m01_BH_corrected<span class="sc">/</span>m0), </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> <span class="fu">mean</span>(m11_BH_corrected<span class="sc">/</span>m1),</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">fdr   =</span> <span class="fu">mean</span>(m01_BH_corrected<span class="sc">/</span>(m01_BH_corrected<span class="sc">+</span>m11_BH_corrected), <span class="at">na.rm=</span><span class="cn">TRUE</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     alpha1 alpha.power   alpha.fdr 
 0.02005833  0.44570000  0.18428226 </code></pre>
</div>
</div>
</section>
</section>
<section id="references" class="level2" data-number="3">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">3 References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-benjamini1995controlling" class="csl-entry" role="doc-biblioentry">
Benjamini, Yoav, and Yosef Hochberg. 1995. <span>“Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing.”</span> <em>Journal of the Royal Statistical Society: Series B (Methodological)</em> 57 (1): 289–300.
</div>
<div id="ref-garcia2014calorie" class="csl-entry" role="doc-biblioentry">
Garcı́a-Arenzana, Nicolás, Eva Marı́a Navarrete-Muñoz, Virginia Lope, Pilar Moreo, Carmen Vidal, Soledad Laso-Pablos, Nieves Ascunce, et al. 2014. <span>“Calorie Intake, Olive Oil Consumption and Mammographic Density Among Spanish Women.”</span> <em>International Journal of Cancer</em> 134 (8): 1916–25. <a href="https://breast-cancer-research.biomedcentral.com/articles/10.1186/bcr2102">https://breast-cancer-research.biomedcentral.com/articles/10.1186/bcr2102</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../docs/tests/map566-lecture-single.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Statistical Tests</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../docs/tests/map566-lab-tests.html" class="pagination-link">
        <span class="nav-page-text">Statistical tests: exercices</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>